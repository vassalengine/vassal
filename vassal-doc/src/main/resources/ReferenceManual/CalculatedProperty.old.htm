<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Calculated Property</title>
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
</head>
<body>
<table border="0" cellpadding="2" cellspacing="2" width="100%">
  <tbody>
  <tr align="left">
  <td valign="top">
  <div align="center">
  </div>
  <h1 align="center">VASSAL Reference Manual</h1>
  <div align="center">
    <small><a href="index.htm">Home</a> &gt; <a href="GameModule.htm">Module</a> &gt; <a href="PieceWindow.htm">Game
    Piece Palette</a></small> <small>&gt; <a href="GamePiece.htm">Game Piece</a></small> <small>&gt; <b>Calculated
    Property</b></small><br>
  </div>
  </td>
  </tr>
  <tr>
  <td valign="top">
  <div align="left">
  </div>
  <hr align="left" size="2" width="100%">
  <div align="left">
  </div>
  <h2 align="left">Calculated Property</h2>
  <div align="center">
    <div align="left">
      <div align="center">
        <img src="images/CalculatedProperty.png" alt=""><br>
      </div>
      <br>
      A Calculated Property defines a <a href="Properties.htm">Property</a> which has a <i>value</i> that is calculated by a
      formula each time it is needed. The property can be referred to by <i>name</i> in other traits in the piece, either for creating 
      <a href="MessageFormat.htm">Message Formats</a> to display messages or in e.g. <a
        href="PropertyMatchExpression.htm">Property Match Expressions</a>. Each place the property <i>name</i> is referred to in an expression, the <i>value</i> will be recalculated and substituted.
      <br>
      <br>
      <b>Property Name:</b>&nbsp;The name of the property that is used to access the formula value.<br>
      <br>
      <b>Expression:</b>&nbsp;A <a href="Expression.htm#beanshell">BeanShell Expression</a> that defines the formula
      that calculates the property value. Immediately to the right of the expression field, a green tick or a red cross
      appears as you are typing that tells you if your <a href="Expression.htm#beanshell">BeanShell Expression</a> is
      valid or not.<br>
      <br>
      <b>Insert:</b>&nbsp;Use the <i>Insert</i> button to access the <a href="Expression.htm#builder">Expression Builder
      </a> to add expression components such as property names, operators and functions. You can also type the formula
      in directly.
      <br><br>
      Note: unlike many fields in VASSAL, Calculated Properties <i>exclusively</i> support <a
        href="Expression.htm#beanshell">BeanShell Expressions</a>. Thus "Old Style VASSAL" comparisons e.g. with single
      = sign are not supported here. The traditional <i>{..}</i> marks around BeanShell
      expressions also do not appear in this context.
      <br><br>
      VASSAL will recalculate the value of the Expression <i>each and every</i> time its value is asked for: whether it
      is referenced in another Calculated Property, an Expression or field in another type of trait, or is displayed in
      a message or a text field. This ensures the value will be kept accurately updated, though module designers should
      be aware that long complicated chains of Calculated Properties can therefore lead to "lag" and slower performance.
    </div>
  </div>
  </td>
  </tr>
  <tr>
  </tr>
  </tbody>
</table>
<br>
<br>
</body>
</html>
